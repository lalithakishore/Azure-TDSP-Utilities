options(warn=-1)
# install required packages
options(repos='http://cran.rstudio.com/')
list.of.packages <- c('Hmisc', 'psych', 'corrgram', 'yaml', 'entropy', 'vcd', 'shiny', 'corrplot', 'scatterplot3d', 'DescTools', 'xtable', 'shinyjs', 'RODBC','parallel','doSNOW','foreach', 'dplyr', 'lubridate')
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,'Package'])]
if(length(new.packages))
install.packages(new.packages)
# intall knitr version 1.12
if (!'knitr' %in% installed.packages()[,'Package']){
knitrurl <- 'http://cran.r-project.org/src/contrib/Archive/knitr/knitr_1.12.tar.gz'
install.packages(knitrurl, repos=NULL, type='source')
} else if ('1.12' != installed.packages()['knitr','Version']){
remove.packages('knitr')
knitrurl <- 'http://cran.r-project.org/src/contrib/Archive/knitr/knitr_1.12.tar.gz'
install.packages(knitrurl, repos=NULL, type='source')
}
library(yaml)
library(RODBC)
library(foreach)
library(shiny)
library(RevoScaleR)
library(devtools)
install_github("RevoEnhancements", "RevoEnhancements")
library(RevoEnhancements)
library(tools)
library(vcd)
# select yaml file
OS_type <- .Platform$OS.type
if (OS_type == 'windows'){
winDialog(type = 'ok', 'Please select the .yaml file in the next popup window. Click OK to proceed.')
} else{
print('Please input the path to the .yaml file.')
}
yaml_file <- file.choose()
config <- yaml.load_file(yaml_file)
if(is.null(config$RowsPerRead)){
config$RowsPerRead <- 500000
} else {
config$RowsPerRead <- as.integer(config$RowsPerRead)
}
# data source
if(is.null(config$DataSource) || config$DataSource == 'local'){
infile <- file.path(config$DataFilePath)
outfile <- paste0(config$DataFilePath,'_mrs.xdf')
if(file_ext(config$DataFilePath)=='xdf'){
data <- RxXdfData(infile)
} else {
#input <- RxTextData(file = infile, delimiter = config$Separator, firstRowIsColNames = config$HasHeader)
#rxImport(inData = input, outFile = outfile, overwrite = TRUE)
rxTextToXdf(inFile = infile, outFile = outfile,  stringsAsFactors = TRUE, overwrite = TRUE, columnDelimiters = config$Separator, firstRowIsColNames = config$HasHeader, reportProgress = 0, rowsPerRead=config$RowsPerRead)
data =  RxXdfData(outfile)
}
} else {
dbhandle <- odbcDriverConnect(paste0('driver={SQL Server};server=',config$Server,';database=',config$Database,';Uid=',config$Username,';Pwd=',config$Password))
dbdata <- RxOdbcData(sqlQuery = config$Query, connectionString = dbhandle)
infile <- file.path(getwd(),'db_mrs.xdf')
rxImport(dbdata, infile , overwrite = TRUE)
data <- RxXdfData(infile)
}
options(warn=-1)
# install required packages
options(repos='http://cran.rstudio.com/')
list.of.packages <- c('Hmisc', 'psych', 'corrgram', 'yaml', 'entropy', 'vcd', 'shiny', 'corrplot', 'scatterplot3d', 'DescTools', 'xtable', 'shinyjs', 'RODBC','parallel','doSNOW','foreach', 'dplyr', 'lubridate')
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,'Package'])]
if(length(new.packages))
install.packages(new.packages)
# intall knitr version 1.12
if (!'knitr' %in% installed.packages()[,'Package']){
knitrurl <- 'http://cran.r-project.org/src/contrib/Archive/knitr/knitr_1.12.tar.gz'
install.packages(knitrurl, repos=NULL, type='source')
} else if ('1.12' != installed.packages()['knitr','Version']){
remove.packages('knitr')
knitrurl <- 'http://cran.r-project.org/src/contrib/Archive/knitr/knitr_1.12.tar.gz'
install.packages(knitrurl, repos=NULL, type='source')
}
library(yaml)
library(RODBC)
library(foreach)
library(shiny)
library(RevoScaleR)
library(devtools)
install_github("RevoEnhancements", "RevoEnhancements")
library(RevoEnhancements)
library(tools)
library(vcd)
# select yaml file
OS_type <- .Platform$OS.type
if (OS_type == 'windows'){
winDialog(type = 'ok', 'Please select the .yaml file in the next popup window. Click OK to proceed.')
} else{
print('Please input the path to the .yaml file.')
}
yaml_file <- file.choose()
source('D:/git/Utilities/DataScienceUtilities/DataReport-Utils/mrs/Run-IDEAR-MRS.R')
packageVersion('knitr')
remove.packages(knitr)
remove.packages('knitr')
source('D:/git/Utilities/DataScienceUtilities/DataReport-Utils/mrs/Run-IDEAR-MRS.R')
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
source('D:/git/Utilities/DataScienceUtilities/DataReport-Utils/mrs/Run-IDEAR-MRS.R')
install.packages("shiny")
install.packages("shiny")
